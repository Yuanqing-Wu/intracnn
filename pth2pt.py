import torch
import net

print('64x64')
model = net.Net64x64()
model.load_state_dict(torch.load("./model/64x64/model_epoch6000.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 64, 64), torch.ones(1, 1, 64, 64), torch.ones(1, 1)))
traced_script_module.save("./model/64x64/model_epoch6000.pt")

print('32x32')
model = net.Net32x32()
model.load_state_dict(torch.load("./model/32x32/model_epoch2500.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 32, 32), torch.ones(1, 1, 32, 32), torch.ones(1, 1)))
traced_script_module.save("./model/32x32/model_epoch2500.pt")

print('16x16')
model = net.Net16x16()
model.load_state_dict(torch.load("./model/16x16/model_epoch2400.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 16, 16), torch.ones(1, 1, 16, 16), torch.ones(1, 1)))
traced_script_module.save("./model/16x16/model_epoch2400.pt")

print('8x8')
model = net.Net8x8()
model.load_state_dict(torch.load("./model/8x8/model_epoch2600.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 8, 8), torch.ones(1, 1, 8, 8), torch.ones(1, 1)))
traced_script_module.save("./model/8x8/model_epoch2600.pt")

print('32x16')
model = net.Net32x16()
model.load_state_dict(torch.load("./model/32x16/model_epoch2400.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 32, 16), torch.ones(1, 1, 32, 16), torch.ones(1, 1)))
traced_script_module.save("./model/32x16/model_epoch2400.pt")

print('32x8')
model = net.Net32x8()
model.load_state_dict(torch.load("./model/32x8/model_epoch2400.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 32, 8), torch.ones(1, 1, 32, 8), torch.ones(1, 1)))
traced_script_module.save("./model/32x8/model_epoch2400.pt")

print('16x8')
model = net.Net16x8()
model.load_state_dict(torch.load("./model/16x8/model_epoch2900.pth"))
model.eval()
traced_script_module = torch.jit.trace(model, (torch.ones(1, 1, 16, 8), torch.ones(1, 1, 16, 8), torch.ones(1, 1)))
traced_script_module.save("./model/16x8/model_epoch2900.pt")